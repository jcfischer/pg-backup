# pg-backup Configuration
# Managed by Ansible - DO NOT EDIT MANUALLY

# Database connection
PG_BACKUP_DB_NAME={{ pg_backup_db_name }}
PG_BACKUP_DB_HOST={{ pg_backup_db_host }}
PG_BACKUP_DB_PORT={{ pg_backup_db_port }}
PG_BACKUP_DB_USER={{ pg_backup_db_user }}
{% if pg_backup_db_password %}
PG_BACKUP_DB_PASSWORD={{ pg_backup_db_password }}
{% endif %}

# Backup storage
PG_BACKUP_DIR={{ pg_backup_dir }}

{% if pg_backup_directories %}
# Directories to backup
PG_BACKUP_DIRS={{ pg_backup_directories }}
{% endif %}

# Retention policy
PG_BACKUP_RETENTION_DAYS={{ pg_backup_retention_days }}
PG_BACKUP_MIN_KEEP={{ pg_backup_retention_min_keep }}

{% if pg_backup_encryption_enabled %}
# Encryption
PG_BACKUP_ENCRYPTION_KEY={{ pg_backup_encryption_passphrase }}
{% endif %}

{% if pg_backup_offsite_type == 's3' %}
# S3 Off-site Sync
PG_BACKUP_OFFSITE_TYPE=s3
PG_BACKUP_S3_BUCKET={{ pg_backup_s3_bucket }}
PG_BACKUP_S3_REGION={{ pg_backup_s3_region }}
PG_BACKUP_S3_ACCESS_KEY_ID={{ pg_backup_s3_access_key_id }}
PG_BACKUP_S3_SECRET_ACCESS_KEY={{ pg_backup_s3_secret_access_key }}
{% if pg_backup_s3_endpoint %}
PG_BACKUP_S3_ENDPOINT={{ pg_backup_s3_endpoint }}
{% endif %}
{% endif %}

{% if pg_backup_offsite_type == 'rsync' %}
# Rsync Off-site Sync
PG_BACKUP_OFFSITE_TYPE=rsync
PG_BACKUP_OFFSITE_HOST={{ pg_backup_rsync_host }}
PG_BACKUP_OFFSITE_USER={{ pg_backup_rsync_user }}
PG_BACKUP_OFFSITE_PATH={{ pg_backup_rsync_path }}
{% if pg_backup_rsync_ssh_key_path %}
PG_BACKUP_OFFSITE_SSH_KEY={{ pg_backup_rsync_ssh_key_path }}
{% endif %}
{% endif %}

{% if pg_backup_alert_enabled %}
# Email Alerts
PG_BACKUP_ALERT_EMAIL={{ pg_backup_alert_to }}
PG_BACKUP_SMTP_HOST={{ pg_backup_alert_smtp_host }}
PG_BACKUP_SMTP_PORT={{ pg_backup_alert_smtp_port }}
PG_BACKUP_SMTP_USER={{ pg_backup_alert_smtp_user }}
PG_BACKUP_SMTP_PASS={{ pg_backup_alert_smtp_password }}
PG_BACKUP_SMTP_FROM={{ pg_backup_alert_from }}
{% endif %}
